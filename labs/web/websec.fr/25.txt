<?php
//get all query parameters
parse_str(parse_url($_SERVER['REQUEST_URI'])['query'], $query);

//die if any (key) value contains "flag"
foreach ($query as $k => $v) {
    if (stripos($v, 'flag') !== false)
        die('You are not allowed to get the flag, sorry :/');
}

//else display
include $_GET['page'] . '.txt';
?>

?a=ag&page=fl.$_GET['a']&send=Submit+Query

